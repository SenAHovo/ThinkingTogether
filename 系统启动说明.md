# 智炬五维协同学习系统 - 启动说明

## 系统架构

本系统采用前后端分离架构：

- **后端**: FastAPI + Python (多智能体系统)
- **前端**: Vue 3 + Vite (用户界面)


## 快速启动

### 方式一：双击启动脚本（推荐）

直接双击项目根目录下的启动脚本：

- **启动后端**: 双击 `启动后端.bat`
- **启动前端**: 双击 `启动前端.bat`

### 方式二：命令行启动

#### 启动后端服务

在项目根目录下执行：

```bash
python -m uvicorn dev.api.server:app --host 0.0.0.0 --port 8000 --log-level info
```

- **端口**: 8000
- **API文档**: http://localhost:8000/docs
- **健康检查**: http://localhost:8000/api/health

#### 启动前端服务

在项目根目录下执行：

```bash
cd FrontDev
npm run dev
```

- **端口**: 5173 (默认)
- **访问地址**: 查看终端输出的实际地址，通常是 http://localhost:5173

**注意**：如果默认端口被占用，Vite会自动尝试5174、5175等端口，请以终端显示的 `Local` 地址为准。

---

## 依赖安装

### 首次运行前需要安装：

**后端依赖**:
```bash
pip install fastapi uvicorn langchain langchain-community langchain-openai python-dotenv httpx
```

**前端依赖**:
```bash
cd FrontDev
npm install
```

---

## 配置说明

系统配置文件位于项目根目录的 `.env` 文件中：

```
# 智谱AI (组织者)
ZHIPU_MODEL_NAME="glm-4-flash"
ZHIPU_API_KEY="your_api_key"

# OpenAI (理论家)
MODEL_NAME="gpt-4o-mini"
API_KEY="your_api_key"
BASE_URL="https://api.openai-proxy.org/v1"

# Kimi (实践者)
KM_MODEL_NAME="moonshot-v1-8k"
KM_API_KEY="your_api_key"
KM_BASE_URL="https://api.moonshot.cn/v1"

# 通义千问 (质疑者)
QWEN_MODEL_NAME="qwen-plus"
QWEN_API_KEY="your_api_key"
QWEN_BASE_URL="https://dashscope.aliyuncs.com/compatible-mode/v1"
```

**⚠️ 注意**: 使用前请先配置好各AI服务的API密钥

---

## 常见问题

### Q: 启动后端时出现 "Failed to fetch" 错误？
A: 检查 `.env` 文件中的模型名称是否正确。智谱AI的模型名称应为 `glm-4-flash`，不能使用 `GLM-4.6V-Flash` 这样的格式。

### Q: 前端无法连接后端？
A: 确认后端服务已启动（访问 http://localhost:8000/api/health 检查）

### Q: 在根目录执行 `npm run dev` 提示缺少脚本？
A: 前端项目在 `FrontDev` 子目录中，需要先执行 `cd FrontDev` 再运行 `npm run dev`，或者直接双击 `启动前端.bat`

### Q: 端口被占用怎么办？

**前端端口（5173）被占用**：
- Vite会自动尝试下一个可用端口（5174、5175等）
- 查看终端输出的 `Local` 地址，使用实际显示的端口访问
- 如果需要释放端口，在Windows下执行：
  ```bash
  # 查看占用端口的进程
  netstat -ano | findstr "5173"
  # 终止进程（替换<PID>为实际进程ID）
  taskkill /PID <PID> /F
  ```

**后端端口（8000）被占用**：
- 使用 `启动后端.bat` 脚本会自动尝试释放端口
- 或手动修改启动命令中的端口号：`--port 8001`
- 或关闭占用端口的程序：
  ```bash
  # 查看占用端口的进程
  netstat -ano | findstr "8000"
  # 终止进程（替换<PID>为实际进程ID）
  taskkill /PID <PID> /F
  ```

---

## 停止服务

- 在命令行窗口按 `Ctrl + C` 停止服务
- 或直接关闭命令行窗口

---

## 项目结构

```
thinking-together/
├── dev/                    # 后端代码
│   ├── api/               # API服务
│   ├── agents/            # 智能体
│   └── memory/            # 记忆存储
├── FrontDev/              # 前端代码
│   ├── src/
│   └── package.json
├── .env                   # 配置文件
├── 启动后端.bat           # 后端启动脚本
├── 启动前端.bat           # 前端启动脚本
└── 系统启动说明.md        # 本文档
```
